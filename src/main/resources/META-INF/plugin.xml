<?xml version="1.0" encoding="UTF-8" ?>
<idea-plugin>
    <!-- Product and plugin compatibility requirements.
         Read more: https://plugins.jetbrains.com/docs/intellij/plugin-compatibility.html -->
    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.modules.java</depends>
    <depends>org.jetbrains.plugins.gradle</depends>

    <!-- Extension points defined by the plugin.
         Read more: https://plugins.jetbrains.com/docs/intellij/plugin-extension-points.html -->
    <extensions defaultExtensionNs="com.intellij"> <!-- Stitcher -->
        <fileType name="Stitcher" language="Stitcher" fieldName="INSTANCE"
                  implementationClass="dev.kikugie.stonecutter.intellij.lang.StitcherFile$StitcherFileType"/>
        <annotator language="Stitcher" implementationClass="dev.kikugie.stonecutter.intellij.editor.StitcherAnnotator"/>
        <completion.contributor language="Stitcher" implementationClass="dev.kikugie.stonecutter.intellij.editor.StitcherCompletionContributor"/>
        <lang.parserDefinition language="Stitcher" implementationClass="dev.kikugie.stonecutter.intellij.lang.StitcherParserDef"/>
        <lang.syntaxHighlighter language="Stitcher" implementationClass="dev.kikugie.stonecutter.intellij.editor.StitcherSyntaxHighlighter"/>
        <lang.syntaxHighlighterFactory language="Stitcher"
                                       implementationClass="dev.kikugie.stonecutter.intellij.editor.StitcherSyntaxHighlighter$Provider"/>
        <lang.braceMatcher language="Stitcher" implementationClass="dev.kikugie.stonecutter.intellij.editor.StitcherBraceMatcher"/>
        <editorHighlighterProvider filetype="Stitcher"
                                   implementationClass="dev.kikugie.stonecutter.intellij.editor.StitcherSyntaxHighlighter$Provider"/>
        <platform.backend.documentation.targetProvider implementation="dev.kikugie.stonecutter.intellij.editor.StitcherDocumentationTargetProvider"/>
    </extensions>

    <extensions defaultExtensionNs="com.intellij"> <!-- Java -->
        <lang.foldingBuilder order="first" language="JAVA" implementationClass="dev.kikugie.stonecutter.intellij.editor.StitcherFoldingBuilder"/>
        <lang.importOptimizer order="first" language="JAVA" implementationClass="dev.kikugie.stonecutter.intellij.editor.StitcherImportOptimizer"/>
        <codeInsight.declarativeInlayProvider group="VALUES_GROUP" language="JAVA" isEnabledByDefault="false" providerId="stitcher-parameters"
                                              bundle="messages.StonecutterBundle" nameKey="stonecutter.plugin.title"
                                              implementationClass="dev.kikugie.stonecutter.intellij.editor.StitcherHintsProvider"/>
    </extensions>

    <extensions defaultExtensionNs="com.intellij"> <!-- Kotlin -->
        <lang.foldingBuilder order="first" language="kotlin" implementationClass="dev.kikugie.stonecutter.intellij.editor.StitcherFoldingBuilder"/>
        <lang.importOptimizer order="first" language="kotlin" implementationClass="dev.kikugie.stonecutter.intellij.editor.StitcherImportOptimizer"/>
        <codeInsight.declarativeInlayProvider group="VALUES_GROUP" language="kotlin" isEnabledByDefault="false" providerId="stitcher-parameters"
                                              bundle="messages.StonecutterBundle" nameKey="stonecutter.plugin.title"
                                              implementationClass="dev.kikugie.stonecutter.intellij.editor.StitcherHintsProvider"/>
    </extensions>

    <extensions defaultExtensionNs="com.intellij"> <!-- Inspections -->
        <!--suppress PluginXmlValidity -->
        <inspection.basicVisitor class="dev.kikugie.stonecutter.intellij.lang.psi.StitcherVisitor"/>
        <lang.inspectionSuppressor language="" order="first"
                                   implementationClass="dev.kikugie.stonecutter.intellij.editor.inspection.outer.CommentInspectionSuppressor"/>

        <localInspection language="" enabledByDefault="true"
                         bundle="messages.StonecutterBundle" groupKey="stonecutter.inspection" key="stonecutter.inspection.late_replacement"
                         implementationClass="dev.kikugie.stonecutter.intellij.editor.inspection.LateReplacementInspection"/>
        <localInspection language="" enabledByDefault="true"
                         bundle="messages.StonecutterBundle" groupKey="stonecutter.inspection" key="stonecutter.inspection.duplicate_replacement"
                         implementationClass="dev.kikugie.stonecutter.intellij.editor.inspection.DuplicateReplacementInspection"/>

        <localInspection language="Stitcher" enabledByDefault="true"
                         bundle="messages.StonecutterBundle" groupKey="stonecutter.inspection" key="stonecutter.inspection.invariant_value"
                         implementationClass="dev.kikugie.stonecutter.intellij.editor.inspection.InvariantValueInspection"/>
        <localInspection language="Stitcher" enabledByDefault="true"
                         bundle="messages.StonecutterBundle" groupKey="stonecutter.inspection" key="stonecutter.inspection.missing_value"
                         implementationClass="dev.kikugie.stonecutter.intellij.editor.inspection.MissingValueInspection"/>
    </extensions>

    <extensions defaultExtensionNs="com.intellij"> <!-- General -->
        <multiHostInjector implementation="dev.kikugie.stonecutter.intellij.editor.StitcherInjector"/>
        <fileBasedIndex implementation="dev.kikugie.stonecutter.intellij.editor.StitcherIndexExtension"/>
        <codeFoldingOptionsProvider instance="dev.kikugie.stonecutter.intellij.settings.StonecutterOptions$FoldingOptions"/>
        <colorSettingsPage implementation="dev.kikugie.stonecutter.intellij.settings.StitcherColorSettingsPage"/>
        <editorHighlighterProvider filetype="Stitcher"
                                   implementationClass="dev.kikugie.stonecutter.intellij.editor.StitcherSyntaxHighlighter$Provider"/>
        <notificationGroup displayType="BALLOON" id="stonecutter-notifications" bundle="messages.StonecutterBundle"
                           key="stonecutter.notifications.group"/>
        <errorHandler implementation="com.intellij.diagnostic.JetBrainsMarketplaceErrorReportSubmitter"/>
        <applicationConfigurable parentId="tools" instance="dev.kikugie.stonecutter.intellij.settings.StonecutterOptions"
                                 id="dev.kikugie.stonecutter.intellij.settings.StonecutterOptions"
                                 displayName="Stonecutter Dev"/>
        <dependencySupport coordinate="dev.kikugie:stonecutter" displayName="Stonecutter" kind="java"/>
        <dependencySupport coordinate="dev.kikugie.stonecutter:dev.kikugie.stonecutter.gradle.plugin" displayName="Stonecutter" kind="java"/>
    </extensions>
    <extensions defaultExtensionNs="org.jetbrains.plugins.gradle">
        <syncContributor implementation="dev.kikugie.stonecutter.intellij.service.GradleReloadListener"/>
    </extensions>
    <actions>
        <action id="dev.kikugie.stonecutter.intellij.select_version"
                text="Switch Active Version"
                icon="/assets/icons/versions.svg"
                class="dev.kikugie.stonecutter.intellij.action.VersionSelectorAction">
            <add-to-group group-id="MainToolbarLeft" anchor="last"/>
        </action>
    </actions>
</idea-plugin>